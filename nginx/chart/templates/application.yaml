apiVersion: marketplace.cloud.google.com/v1
kind: Application
metadata:
  annotations:
    marketplace.cloud.google.com: |
      {"name":"NGINX","version":"v0.1","description":"An HTTP and reverse proxy server, a mail proxy server, and a generic TCP/UDP proxy server.","url":"nginx.com","tagline":"nginx","support_info":"Community support","documentations":[{"url":"https://www.nginx.com/resources/wiki/start/","title":"Getting Started","description":"A quick walkthrough"}]}
  ApplicationStatus:
    ready: true
  generation: 0
  initializers: null
  name: "{{ .Values.APP_INSTANCE_NAME }}"
  namespace: "{{ .Values.NAMESPACE }}"
spec:
  components:
  - {{ .Values.APP_INSTANCE_NAME }}:
      kind: Deployment
  - {{ .Values.APP_INSTANCE_NAME }}:
      kind: Service
  - {{ .Values.APP_INSTANCE_NAME }}-controller:
      kind: Deployment
  - {{ .Values.APP_INSTANCE_NAME }}-controller-sa:
      kind: ServiceAccount
  - {{ .Values.APP_INSTANCE_NAME }}-controller-approle:
      kind: Role
  - {{ .Values.APP_INSTANCE_NAME }}-controller-apprb:
      kind: RoleBinding
  - {{ .Values.APP_INSTANCE_NAME }}-controller-editrb:
      kind: RoleBinding
  # The following shouldn't be listed here. They are not part of the
  # application itself, and the solution crafter shouldn't have to worry
  # about them. See TODOs above.
  - {{ .Values.APP_INSTANCE_NAME }}-deployer:
      kind: Job
  - {{ .Values.APP_INSTANCE_NAME }}-deployer-sa:
      kind: ServiceAccount
  - {{ .Values.APP_INSTANCE_NAME }}-deployer-role:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
  - {{ .Values.APP_INSTANCE_NAME }}-deployer-rb:
      apiGroup: rbac.authorization.k8s.io
      kind: RoleBinding
